__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FORMAT_FOR_P5=e.FORMAT_FOR_P3=e.FORMAT_FOR_P2=e.FORMAT_FOR_EXPERIENCES_P5=e.FORMAT_FOR_EXPERIENCES_P4=e.FORMAT_FOR_EXPERIENCES_P3=void 0,e.initRemarketingData=function(s,p,O=!1){if(!u.default.getBootstrap('paid_growth_tracking_data'))return Promise.resolve(f);const l="/v2/paid_growth_tracking_datas?_format="+s,E=`${l}/${(0,n.getBev)()}`,F=o.default.current().id||(0,n.getBev)(),c=`${l}/${F}`;if(O){const _=(0,t.default)(c);if(_)return o.default.isLoggedIn()&&(0,t.default)(E,_,{expires:864e5}),Promise.resolve(_)}return new Promise(n=>{R().default.post("/api"+l,{body:JSON.stringify(p||{})}).then(u=>{const R=(0,_().v4)(),f={...u.paid_growth_tracking_data,event_id:R};return O&&((0,t.default)(c,f,{expires:864e5}),o.default.isLoggedIn()&&(0,t.default)(E,f,{expires:864e5})),n(f)}).catch(()=>{n(f)})})};var t=babelHelpers.interopRequireDefault(r(d[0]));function _(){const t=r(d[1]);return _=function(){return t},t}var n=r(d[2]),o=babelHelpers.interopRequireDefault(r(d[3])),u=babelHelpers.interopRequireDefault(r(d[4]));function R(){const t=babelHelpers.interopRequireDefault(r(d[5]));return R=function(){return t},t}const f={};e.FORMAT_FOR_P2='for_p2';e.FORMAT_FOR_P3='for_p3';e.FORMAT_FOR_P5='for_p5';e.FORMAT_FOR_EXPERIENCES_P3='for_experiences_p3';e.FORMAT_FOR_EXPERIENCES_P4='for_experiences_p4';e.FORMAT_FOR_EXPERIENCES_P5='for_experiences_p5'}),"1949a1",["1f339e","305dd5","4304c2","06a99e","c235f8","69a7c4"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updateP2Remarketing=function({filters:f,listingIds:b=[],geography:k,remarketingIds:v,canonicalLocation:I}){const R=new RegExp("=(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))(&|$)"),S=decodeURIComponent(window.location.href),L=R.test(S);L&&o.default.logEvent({event_name:'urls_with_pii',event_data:{url:S,datadog_key:'paid_growth.urls_with_pii',datadog_tags:'source:p2'}});return(function(f){return(0,p.initRemarketingData)(p.FORMAT_FOR_P2,{}).then(p=>{p&&"optout"!==p.audience_type&&(function({canonicalLocation:p,categoryTag:f,checkin:b,checkout:k,topListingIds:v,city:I,state:R,country:S,num_adults:L,num_children:P,num_infants:w,filters:A,remarketingIds:D,resultIds:x,urlContainsPII:H},N){var q;const E=_.default.makeGoogleDynxParams("searchresults",v,b,k);E.dynx_pagetype='p2',E.dynx_itemid=(0,l.locationToURLParameter)(p).toLowerCase(),(0,y.pushEventsToDataLayer)([{data:{dynx_params:E,urlContainsPII:H}},{event:'searchListings',data:{user_country:t.default.country(),top_listing_ids:v,city:I,state:R,country:S,num_adults:L,num_children:P,num_infants:w,...N}}]),h().default.post("/api/v2/marketing_event_tracking",{body:JSON.stringify({event_type:'SEARCH_LISTINGS',event_data:{audience_type:N.audience_type,category_tag:f,checkin_date:b,checkout_date:k,city:I,country:S,has_account:_.default.hasAccount().toString(),num_adults:null==L?void 0:L.toString(),num_children:null==P?void 0:P.toString(),num_infants:null==w?void 0:w.toString(),searched_string:A.location,state:R,user_bucket:null===(q=N.user_bucket)||void 0===q?void 0:q.toString()}})}),A.work_trip&&(0,y.default)({event:'workTripSearchListings',data:{user_country:t.default.country()}});b&&k&&(0,y.default)({event:'searchListingsWithDates',data:{user_country:t.default.country()}});if(c.default.getBootstrap('remarketing_jitney_logging'))try{const c=JSON.stringify({...N,city:I,region:R,country:S,user_country:t.default.country(),dynxParams:E});o.default.logJitneyEvent({schema:n().PaidGrowthHomeSearchPixelEvent,event_data:{search_results:(x||[]).map(Number),search_results_str:x||[],remarketing_ids:(D||[]).map(Number),remarketing_ids_str:D||[],subtab:2,device_id:(0,s.getBev)()||'',user_id:u.default.current().id,checkin_date:A.checkin,checkout_date:A.checkout,guests:A.guests||1,adults:A.adults||1,children:A.children,infants:A.infants,pets:A.amenities&&A.amenities.includes(12),instant_book:A.ib,price_min:A.price_min,price_max:A.price_max,room_types:A.room_types?A.room_types.map(t=>'Entire home/apt'===t?3:'Private room'===t?2:'Shared room'===t?1:3):void 0,beds:A.min_beds,bedrooms:A.min_bedrooms,bathrooms:A.min_bathrooms,amenities:A.amenities,audience_type:N.audience_type,user_bucket:N.user_bucket,custom_data:c}})}catch(t){}})(f,p)})})({canonicalLocation:I,categoryTag:f.category_tag||'',checkin:f.checkin||'',checkout:f.checkout||'',topListingIds:Array.isArray(v)&&v.length>0?v.slice(0,10):b.slice(0,10),city:k?k.city:'N/A',state:k?k.state:'N/A',country:k?k.country:'N/A',num_adults:f.adults||1,num_children:f.children||0,num_infants:f.infants||0,filters:f,remarketingIds:v,resultIds:b,urlContainsPII:L})};var t=babelHelpers.interopRequireDefault(r(d[0]));function n(){const t=r(d[1]);return n=function(){return t},t}var s=r(d[2]),o=babelHelpers.interopRequireDefault(r(d[3])),u=babelHelpers.interopRequireDefault(r(d[4])),c=babelHelpers.interopRequireDefault(r(d[5])),l=r(d[6]),_=babelHelpers.interopRequireDefault(r(d[7])),p=r(d[8]),y=babelHelpers.interopRequireWildcard(r(d[9]));function h(){const t=babelHelpers.interopRequireDefault(r(d[10]));return h=function(){return t},t}}),"26b25a",["862e50","af12d7","4304c2","c8b97a","06a99e","c235f8","f4229b","387550","1949a1","c1f92a","69a7c4"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=babelHelpers.interopRequireDefault(r(d[0])),l=babelHelpers.interopRequireDefault(r(d[1])),o=babelHelpers.interopRequireDefault(r(d[2])),u=babelHelpers.interopRequireDefault(r(d[3])),n=r(d[4]);const s=l.default.format('rails_format');var c={localizedToCriteoDate:l=>l?(0,t.default)(l,s).format('MM/DD/YYYY'):'',localizedToGoogleDate:l=>l?(0,t.default)(l,"YYYY-MM-DD",!0).isValid()?l:(0,t.default)(l,s).format("YYYY-MM-DD"):'',hasAccount:()=>null!=u.default.current().id||!!(0,o.default)('hli'),makeGoogleDynxParams(t,l,o,u){return{hrental_pagetype:t,hrental_id:l,hrental_startdate:this.localizedToGoogleDate(o),hrental_enddate:this.localizedToGoogleDate(u),has_account:this.hasAccount()}},saveSearchFilters(l){if(!l.checkin||!l.checkout)return;const u=(0,t.default)(l.checkin,"YYYY-MM-DD",!0).isValid()?(0,t.default)(l.checkin,"YYYY-MM-DD"):(0,t.default)(l.checkin,s),c=(0,t.default)(l.checkout,"YYYY-MM-DD",!0).isValid()?(0,t.default)(l.checkout,"YYYY-MM-DD"):(0,t.default)(l.checkout,s),f=l.guests?String(l.guests):'',Y=l.adults?String(l.adults):'',D=l.children?String(l.children):'',h=l.infants?String(l.infants):'';let M=0;if(l.room_types)for(let t=0;t<l.room_types.length;t+=1){const o=l.room_types[t];'Entire home/apt'===o?M+=1:'Private room'===o?M+=2:'Shared room'===o&&(M+=4)}(0,o.default)('lsf',u.format("YYYY-MM-DD").concat(',',c.format("YYYY-MM-DD"),',',f,',',Y,',',D,',',h,',',String(M)),{expires:u.diff((0,t.default)(),'days')+1,path:'/',domain:(0,n.getCookieHost)()})}};e.default=c}),"387550",["1772c9","c0752c","e7272f","06a99e","5b85ba"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PaidGrowthHomeSearchPixelEvent=void 0;var o={defaultProps:{schema:'com.airbnb.jitney.event.logging.PaidGrowth:PaidGrowthHomeSearchPixelEvent:4.0.0',event_name:'paidgrowth_home_search_pixel',operation:20},propTypes:{}};e.PaidGrowthHomeSearchPixelEvent=o,o.fullyQualifiedName='PaidGrowth.v4.PaidGrowthHomeSearchPixelEvent'}),"af12d7",[]);
__d((function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=u,e.pushEventsToDataLayer=function(t){t.forEach(t=>u(t))};var n=babelHelpers.interopRequireDefault(r(d[1])),o=r(d[2]);function u({event:u,data:l={},eventCallback:c,eventTimeout:v}){{window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:u,...c&&{eventCallback:()=>{c()}},...v&&{eventTimeout:v},...l});const s=Object.fromEntries(Object.entries(l).map(([t,n])=>[t,String(n)]));n.default.logJitneyEvent({schema:t().GoogleTagManagerDataLayerPushEvent,event_data:{data_layer_event_name:u||'',data_layer_event_data:s}}),(0,o.airdogCount)('gtm.datalayer.push',1,["event:"+(u||'')])}}}),"c1f92a",["cd167e","c8b97a","3e4681"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GoogleTagManagerDataLayerPushEvent=void 0;var o={defaultProps:{schema:'com.airbnb.jitney.event.logging.GoogleTagManager:GoogleTagManagerDataLayerPushEvent:1.0.0',event_name:'googletagmanager_data_layer_push'},propTypes:{}};e.GoogleTagManagerDataLayerPushEvent=o,o.fullyQualifiedName='GoogleTagManager.v1.GoogleTagManagerDataLayerPushEvent'}),"cd167e",[]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(d[0]),n=r(d[1]),c=r(d[2]),s=babelHelpers.interopRequireDefault(r(d[3])),u=r(d[4]),o=r(d[5]),l=r(d[6]);function E(t){switch(t){case u.EXPLORE_TABS.SELECT_HOMES:case u.EXPLORE_TABS.HOMES:case u.EXPLORE_TABS.LUXURY:return'homes';case u.EXPLORE_TABS.EXPERIENCES:case u.EXPLORE_TABS.ADVENTURES:return'experiences';default:return null}}var f=function(u){const{remarketingIds:f,canonicalLocation:p,city:R,state:h,country:_}=u,y=(0,s.default)(),{checkin:P,checkout:S,adults:T,children:k,infants:L,pets:v,category_tag:O}=y,X=(0,t.useRef)(y);X.current=y;const{abort:b,scheduler:A}=(0,o.usePostTaskScheduler)({priority:'background',strategy:'recycle'});return(0,t.useEffect)(()=>{const t=(0,l.getTabFromRefinementPaths)(X.current.refinement_paths),s={city:null!=R?R:void 0,state:null!=h?h:void 0,country:null!=_?_:void 0};return'homes'===E(t)?A.postTask(()=>{(0,n.updateP2Remarketing)({canonicalLocation:p||'',filters:X.current,geography:s,listingIds:[],remarketingIds:f||void 0})}):'experiences'===E(t)&&A.postTask(()=>{(0,c.updateP2RemarketingExperience)({filters:X.current,geography:s})}),b},[R,_,h,p,P,S,T,k,L,v,O,b,A]),null};e.default=f}),"d31cce",["a27fc3","26b25a","dbc503","f98e43","87916a","53bb4a","1b01f9"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updateP2RemarketingExperience=function({filters:u,geography:c}){const{checkin:f,checkout:s,adults:l,children:o,infants:h,refinement_paths:p}=u,y=p&&p[0]||'',O=y.split('/').pop();!(function({checkin:u,checkout:c,city:f,state:s,country:l,numOfAdults:o,numOfChildren:h,numOfInfants:p,refinementPath:y,refinement:O}){(0,n.default)({event:'searchExperiences',data:{user_country:t.default.country(),city:f,state:s,country:l,checkin:u,checkout:c,numOfAdults:o,numOfChildren:h,numOfInfants:p,refinementPath:y,refinement:O}}),(u||c)&&(0,n.default)({event:'searchExperiencesWithDates',data:{user_country:t.default.country()}})})({checkin:f||'',checkout:s||'',city:c?c.city:'N/A',state:c?c.state:'N/A',country:c?c.country:'N/A',numOfAdults:l||1,numOfChildren:o||0,numOfInfants:h||0,refinementPath:y,refinement:O})};var t=babelHelpers.interopRequireDefault(r(d[0])),n=babelHelpers.interopRequireDefault(r(d[1]))}),"dbc503",["862e50","c1f92a"]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/stays-search/sections/client/StaysRemarketing/StaysRemarketing.dcaf03ebdc.js.map